parameters:
 kubernetes_version: '1.14.0'
 kubevirt_version: latest
 cdi_version: latest
 rook_version: latest
 domain: cnvlab.gce.sysdeseng.com
 disk_size: 20
 rook_disk_size: 30
 numcpus: 4
 memory: 12288
 nodes: 1
 deploy: true
 emulation: false
 keys:
 - ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQC5Qbj7vDf0uYQpeYb432g5R4YvYJaPfPA4EM4qc3lO62c7oUsWbZlZBl5neEWX41HGCIP4Zm1ybN9iiDyeIns6hg5OkU2vUGuPtV2KCAZOI7snzXeZxlrjsVMjMy/CYUlvIOAPxY4XzfzMMAJjIJni18R2PqVRI4f4SeSq3IIzpnOu2VQmqjFmmdybQY83BvBvWj6KLszAXkJk9LkZSAoktXimDBWFPQYikzZihLolRxwHzo21lXSw58D1N+6IeMudOviAte5yu6FBUN6dFYbt9dkLuH2/ONliFz/042n5UNp0wC5BLdpVwJpWqqrCVaeXBgla/gYm8YNZJIAlf8K5 kboumedh@vegeta.local
 tags:
 - cnvlab
 kubevirt: true
 cdi: true
 rook: true
 istio: true
 knative: true
 kafka: true

{% for node in range(0, nodes) %}
student{{ "%03.d" | format(node+1) }}:
{% if type == 'gcp' %}
 template: nested-centos7
{% else %}
 template: CentOS-7-x86_64-GenericCloud.qcow2
{% endif %}
 numcpus: {{ numcpus }}
 memory: {{ memory }}
 tags: {{ tags }}
 keys: {{ keys }}
 domain: {{ domain }}
 reservedns: true
 nets:
  - name: default
    alias: ['*']
 disks:
  - size: {{ disk_size }}
  - size: {{ rook_disk_size }}
 pool: default
 files: 
  - kubernetes.sh
  - path: /etc/yum.repos.d/kubernetes.repo
    origin: kubernetes.repo
  - kubevirt.sh
  - cdi.sh
  - rook.sh
  - istio.sh
  - knative.sh
  - kafka.sh
  - rook_pool.yml
  - rook_sc.yml
 scripts:
  - requirements.sh
{% if deploy %}
  - deploy.sh
{% endif %}
{% endfor %}
